{% extends "portal/base.html" %}

{% block content %}
  <h1>{{ committee }} Committee</h1>
  {% if semester %}
    <p>Semester: {{ semester.name }}</p>
  {% else %}
    <p>No active semester set.</p>
  {% endif %}

  <section>
    <h3>Budget</h3>
    {% if allocation %}
      <p>Allocated: {{ allocation.allocated_cents / 100 }}</p>
      <p>Remaining: {{ remaining_cents / 100 }}</p>
    {% else %}
      <p>No allocation set yet.</p>
    {% endif %}
  </section>

  <section>
    <h3>Transactions</h3>
    {% if transactions %}
      <table>
        <thead>
          <tr>
            <th>Amount</th>
            <th>Vendor</th>
            <th>Memo</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for tx in transactions %}
            <tr>
              <td>{{ tx.amount_cents / 100 }}</td>
              <td>{{ tx.vendor or "" }}</td>
              <td>{{ tx.memo or "" }}</td>
              <td>
                <form method="post" action="{{ url_for('portal.delete_committee_transaction', transaction_id=tx.id) }}">
                  <button type="submit">Delete</button>
                </form>
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <p>No transactions recorded.</p>
    {% endif %}
  </section>

  <section>
    <h3>Add Transaction</h3>
    <form method="post" action="{{ url_for('portal.create_committee_transaction', committee=committee) }}">
      <label>Amount (cents) <input name="amount_cents" required></label>
      <label>Direction
        <select name="direction">
          <option value="spend">Spend</option>
          <option value="refund">Refund</option>
        </select>
      </label>
      <label>Vendor <input name="vendor"></label>
      <label>Category <input name="category"></label>
      <label>Memo <textarea name="memo"></textarea></label>
      <button type="submit">Save</button>
    </form>
  </section>
{% endblock %}
