{% extends "portal/base.html" %}

{% block content %}
  <h1>Treasurer</h1>
  {% if semester %}
    <p>Current semester: {{ semester.name }}</p>
  {% else %}
    <p>No active semester set.</p>
  {% endif %}

  <section>
    <h3>Committee Allocations</h3>
    {% if allocations %}
      <ul>
        {% for allocation in allocations %}
          <li>{{ committees.get(allocation.committee_id, allocation.committee_id) }} - {{ allocation.allocated_cents / 100 }}</li>
        {% endfor %}
      </ul>
    {% else %}
      <p>No allocations yet.</p>
    {% endif %}
    <form method="post" action="{{ url_for('portal.create_allocation') }}">
      <label>Committee
        <select name="committee">
          <option value="Brotherhood">Brotherhood</option>
          <option value="Social">Social</option>
          <option value="Recruitment">Recruitment</option>
        </select>
      </label>
      <label>Allocated (cents) <input name="allocated_cents" required></label>
      <label>Notes <textarea name="notes"></textarea></label>
      <button type="submit">Save Allocation</button>
    </form>
  </section>

  <section>
    <h3>Record Dues Charges</h3>
    <form method="post" action="{{ url_for('portal.create_dues_batch') }}">
      <label>Charge (cents) <input name="charge_cents" required></label>
      <label>Reason <input name="reason" value="Semester dues"></label>
      <button type="submit">Create Charges</button>
    </form>
  </section>

  <section>
    <h3>Record Dues Payment</h3>
    <form method="post" action="{{ url_for('portal.record_dues_payment') }}">
      <label>User ID <input name="user_id" required></label>
      <label>Amount (cents) <input name="amount_cents" required></label>
      <label>Method <input name="method" value="cash"></label>
      <label>Notes <input name="notes"></label>
      <button type="submit">Record Payment</button>
    </form>
  </section>

  <section>
    <h3>Master Ledger</h3>
    {% if ledger %}
      <ul>
        {% for entry in ledger %}
          <li>{{ entry.amount_cents / 100 }} - {{ entry.memo or "" }}</li>
        {% endfor %}
      </ul>
    {% else %}
      <p>No ledger entries yet.</p>
    {% endif %}
  </section>
{% endblock %}
